#!/usr/bin/env php
<?php

$words = [
    'skausmas',
    'kančia',
    'pragaras',
    'dykuma',
    'tuščias gyvenimas',
    'egzistencija',
    'skerdykla',
    'mėsmalė',
    'pabaiga',
    'nepavykę santykiai',
    'pabaiga be pradžios',
    'depresija',
    'demonai',
    'velniai',
    'trauma',
    'klaidos',
    'vienišumas',
    'pagalbos šauksmas',
    'širdies skausmas',
    'skilimas',
    'puvimas',
    'šlapdriba',
    'pasėkmės',
    'tamsa',
];

$paragraphCount = $argv[1] ?? 1;
$wordCount = $argv[2] ?? count($words);

$carry = array_fill(0, $paragraphCount * (count($words) / $wordCount), $words);

$carry = array_map(
    callback: function ($words) use ($wordCount) {
        shuffle($words);

        $words = array_slice($words, 0, $wordCount);

        $sentences = [];

        while (count($words) > 0) {
            $sentence = array_splice($words, 0, rand(2, 4));

            $sentences[] = ucfirst(implode(' ', $sentence));
        }

        return $sentences;
    },

    array: $carry,
);

$carry = array_merge(...$carry);

$paragraphs = array_chunk(
    array: $carry,
    length: round(count($carry) / $paragraphCount),
);

$paragraphs = array_map(
    callback: fn ($sentences) => implode('. ', $sentences) . '.',
    array: $paragraphs,
);

echo implode("\n\n", $paragraphs);
